name: Ruff
on: [push]
jobs:
  ruff-check:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4
        
      - name: Install Ruff
        run: pip install ruff

      - name: Fix and Format
        run: |
          ruff check --fix --per-file-ignores "test/*:S101,D" --per-file-ignores "scratch_chat.py:F811" --per-file-ignores ".archive/*:ALL" --per-file-ignores "scratch_chat.py:F811"
          ruff format .

      - name: Generate UUID
        uses: Boss-1s/generate-uuid@v1.4
        id: uuid
        with:
          version: 7

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v6
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: "style: auto-fix linting and formatting with Ruff"
          title: "Automated Ruff Fixes"
          body: "This is an automated PR generated by Ruff to ensure PEP 8 compliance."
          branch: 'ruff-auto-fixes-${{ steps.uuid.outputs.uuid }}'
